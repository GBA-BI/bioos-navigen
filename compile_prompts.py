import glob
import os

OUTPUT_FILE = "GEMINI.md"
HEADER = """<!-- AUTO-GENERATED FILE. DO NOT EDIT DIRECTLY. -->
<!-- Generated by compile_prompts.py -->

"""

def compile_prompts():
    files = sorted(glob.glob("system_prompt/*.md"))

    with open(OUTPUT_FILE, 'w', encoding='utf-8') as outfile:
        outfile.write(HEADER)

        for filepath in files:
            filename = os.path.basename(filepath)
            print(f"Processing {filename}...")

            outfile.write(f"<!-- Source: {filename} -->\n")

            try:
                with open(filepath, 'r', encoding='utf-8') as infile:
                    content = infile.read()
                    outfile.write(content)
                    # Ensure there is a newline at the end of the file content
                    if not content.endswith('\n'):
                        outfile.write('\n')
            except Exception as e:
                print(f"Error reading {filepath}: {e}")
                continue

            outfile.write("\n") # Add extra separation

    print(f"Successfully compiled {len(files)} files into {OUTPUT_FILE}")

if __name__ == "__main__":
    compile_prompts()
